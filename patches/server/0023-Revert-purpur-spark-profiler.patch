From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Dreeam <61569423+Dreeam-qwq@users.noreply.github.com>
Date: Mon, 24 Oct 2022 01:10:37 -0400
Subject: [PATCH] Revert purpur spark profiler


diff --git a/src/main/java/org/bukkit/craftbukkit/CraftServer.java b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
index 4f029b96bf8deee597dbb56974e4519a1422f96d..a1f37a75d94cffbb412e48cdffec836eaad8300a 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftServer.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
@@ -435,38 +435,7 @@ public final class CraftServer implements Server {
             if (!pluginFolder.exists()) {
                 pluginFolder.mkdirs();
             }
-            // Purpur start
-            List<File> extraJars = this.extraPluginJars();
-            if (!Boolean.getBoolean("Purpur.IReallyDontWantSpark")) {
-                try {
-                    File file = new File("cache", "spark.jar");
-                    file.getParentFile().mkdirs();
-
-                    boolean shouldDownload = true;
-                    if (file.exists()) {
-                        String fileSha1 = String.format("%040x", new java.math.BigInteger(1, java.security.MessageDigest.getInstance("SHA-1").digest(java.nio.file.Files.readAllBytes(file.toPath()))));
-                        String sparkSha1;
-                        try (java.io.BufferedReader reader = new java.io.BufferedReader(new InputStreamReader(new java.net.URL("https://sparkapi.lucko.me/download/bukkit/sha1").openStream()))) {
-                            sparkSha1 = reader.lines().collect(Collectors.joining(""));
-                        }
-
-                        if (fileSha1.equals(sparkSha1)) {
-                            shouldDownload = false;
-                        }
-                    }
-
-                    if (shouldDownload) {
-                        java.nio.file.Files.copy(new java.net.URL("https://sparkapi.lucko.me/download/bukkit").openStream(), file.toPath(), java.nio.file.StandardCopyOption.REPLACE_EXISTING);
-                    }
-
-                    extraJars.add(file);
-                } catch (Exception e) {
-                    getLogger().severe("Purpur: Failed to download and install spark plugin");
-                    e.printStackTrace();
-                }
-            }
-            Plugin[] plugins = this.pluginManager.loadPlugins(pluginFolder, extraJars);
-            // Purpur end
+            Plugin[] plugins = this.pluginManager.loadPlugins(pluginFolder, this.extraPluginJars());
             // Paper end
             for (Plugin plugin : plugins) {
                 try {
